# Face_Recognition_using_esp32-s3

This repository contains a face recognition system built using MobileNetV2, optimized for deployment on ESP32-S3 via PlatformIO. The project involves training the model, generating an INT8 quantized version, and integrating it with ESP32-S3 for efficient edge inference.

**Features**

Preprocessing: Converts images to RGB, resizes to 128x128 pixels, and normalizes pixel values.

Data Augmentation: Includes random rotations, shifts, shear, zoom, and flips to improve model generalization.

Model Architecture: Uses MobileNetV2 as the base model with a dropout layer and softmax output for classification.

Evaluation: Provides test accuracy, classification reports, and latency measurements.

Quantization: Converts the trained model to TFLite format with INT8 quantization for efficient inference.

ESP32-S3 Integration: Deploys the quantized model to ESP32-S3 for edge-based face recognition.

**Prerequisites**

Ensure the following are installed:

Python 3.7+

TensorFlow 2.x

NumPy

scikit-learn

PIL (Pillow)

PlatformIO

ESP-IDF (for ESP32-S3)

**Dataset**

Place your face image dataset in the dataset directory. Ensure images are named in the format image.<label>.jpg, where <label> is the class index starting from 1.
You have to build you own dataset. Also, Try to get the images more than 1000 in different views and lightening conditions.
How to Run

**Step 1: Clone the Repository**

git clone https://github.com/<your-username>/face-recognition-esp32s3.git
cd face-recognition-esp32s3

**Step 2: Install Dependencies**

pip install -r requirements.txt

**Step 3: Train the Model**

The training is availabe in the Face_Recognition folder in this reposit. I suggest tou to take this code and run the code in google colab. Then install the platformIO in vscode to run the model generated by the code in the esp32-s3. The codes to run in the esp32-s3 are also availabe in this repository, But, there are not well structured.Cantact me to implement this project. 


**Step 4: Deploy to ESP32-S3**

Set up PlatformIO and create a new project for ESP32-S3.

Copy the model-int8.cc file to the data directory of your PlatformIO project.

Use the TensorFlow Lite Micro library to load and run the model on ESP32-S3.

Flash the project to your ESP32-S3 device:

platformio run --target upload

**Performance Metrics**

Test Accuracy: Displayed during evaluation.

Model Size: Approx. 2.5 MB for the original model and smaller for the quantized model.

Latency: Measured and printed for a single inference.

Classification Report: Includes precision, recall, and F1-score.

